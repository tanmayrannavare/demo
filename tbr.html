<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>AWS Assignment</title>
  <style>
    body {
      font-family: system-ui, sans-serif;
      margin: 2rem;
      line-height: 1.6;
    }
    code {
      background: #f4f4f4;
      padding: 2px 5px;
      border-radius: 4px;
    }
    pre {
      background: #f4f4f4;
      padding: 1rem;
      border-radius: 5px;
      overflow-x: auto;
    }
    h1, h2, h3 {
      color: #333;
    }
    hr {
      margin: 2rem 0;
    }
  </style>
</head>
<body>

<h1>AWS Assignment</h1>

<h2>ðŸ”‘ Prerequisites:</h2>
<ul>
  <li>Laptop with internet access.</li>
  <li>AWS Free Tier account (credit/debit card required for signup).</li>
  <li>Basic Linux commands knowledge (yum, apt, curl).</li>
</ul>

<h3>In AWS:</h3>
<ul>
  <li>VPC (10.0.0.0/16): SUBNET(PUBLIC(10.0.1.0/24) AND PRIVATE(10.0.2.0/24))</li>
  <li>ROUTE, NAT, SECURITY GROUP (SSH, HTTP AND PORT 8080 for Docker)</li>
  <li>Create the key (.pem) same for all EC2 virtual machines!</li>
</ul>

<h2>Objectives</h2>
<p>Stand up a basic two-subnet VPC in AWS (public + private).</p>

<h2>Launch:</h2>
<ul>
  <li>Private EC2 (no public IP) â€” Ansible control node.<br>Use Elastic IP for private EC2 for installation</li>
  <li>Jump host in public subnet â€” for SSH into the private EC2.</li>
</ul>

<pre><code>
If you donâ€™t know how to copy directly, donâ€™t worry.
Just view your downloaded .pem file using Notepad and copy the key.
Paste it to virtual machine using: nano key.pem
Then set permissions:
chmod 400 key.pem !!!
</code></pre>

<p><strong>Web server</strong> in public subnet.</p>

<pre><code>
use sudo for docker command
</code></pre>

<p>
From the private EC2, run the provided Ansible playbook to install Apache on the public web server
and serve a page with Name + Roll No. Additionally, containerize a simple Apache site by building a basic Docker image that serves the same page.
</p>

<h2>Deliverables (brief)</h2>
<ul>
  <li>Public web server URL showing Name + Roll No.</li>
  <li>One screenshot of Ansible run completion.</li>
  <li>One screenshot of your Docker container serving the same page locally (docker run â€¦).</li>
  <li>One diagram or bullet list of your VPC + subnets + instances (very brief).</li>
</ul>

<hr>

<h2>Installation</h2>

<h3>Installing Ansible (on the Private EC2)</h3>
<p>Once your private EC2 instance is reachable (via SSH from your jump host), install Ansible:</p>

<h4>ðŸŸ¢ Amazon Linux 2 / RHEL / CentOS</h4>
<pre><code>sudo yum update -y
sudo yum install -y ansible
# or
sudo amazon-linux-extras install ansible2 -y
ansible --version
</code></pre>

<h4>ðŸ”µ Ubuntu / Debian</h4>
<pre><code>sudo apt update -y
sudo apt install -y ansible
ansible --version
</code></pre>

<h3>inventory.ini</h3>
<pre><code>
[web]
&lt;public-web-server-ip&gt; ansible_user=ubuntu ansible_ssh_private_key_file=/yourpath/key.pem
# For Amazon Linux 2
&lt;public-web-server-ip&gt; ansible_user=ec2-user ansible_ssh_private_key_file=/yourpath/key.pem
</code></pre>

<h3>Site.yml</h3>
<pre><code>---
- name: Bootstrap Apache and deploy Name/Roll page
  hosts: web
  become: true
  gather_facts: true

  vars:
    apache_pkg: "{{ 'httpd' if ansible_facts.os_family in ['RedHat','Amazon'] else 'apache2' }}"
    apache_svc: "{{ 'httpd' if ansible_facts.os_family in ['RedHat','Amazon'] else 'apache2' }}"
    doc_root: "/var/www/html"
    student_name: "{{ lookup('env','STUDENT_NAME') | default('Your Name', true) }}"
    roll_no: "{{ lookup('env','ROLL_NO') | default('0000', true) }}"

  tasks:
    - name: Ensure package cache is up to date (Debian/Ubuntu)
      apt:
        update_cache: yes
      when: ansible_facts.os_family == 'Debian'

    - name: Install Apache
      package:
        name: "{{ apache_pkg }}"
        state: present

    - name: Ensure Apache service is enabled and running
      service:
        name: "{{ apache_svc }}"
        state: started
        enabled: true

    - name: Deploy index.html with Name and Roll No
      copy:
        dest: "{{ doc_root }}/index.html"
        mode: '0644'
        content: |
          &lt;!doctype html&gt;
          &lt;html&gt;
            &lt;head&gt;&lt;meta charset="utf-8"&gt;&lt;title&gt;Student&lt;/title&gt;&lt;/head&gt;
            &lt;body style="font-family: system-ui; margin: 3rem;"&gt;
              &lt;h1&gt;{{ student_name }}&lt;/h1&gt;
              &lt;h2&gt;Roll No: {{ roll_no }}&lt;/h2&gt;
              &lt;p&gt;Deployed via Ansible âœ…&lt;/p&gt;
            &lt;/body&gt;
          &lt;/html&gt;
</code></pre>

<h3>Set Your Environment Variables</h3>
<pre><code>
export STUDENT_NAME="xyz xyz"
export ROLL_NO="123456"
</code></pre>

<h3>Run Ansible Commands</h3>
<pre><code>
ansible -i inventory.ini web -m ping
ansible-playbook -i inventory.ini site.yml
</code></pre>

<hr>

<h2>Dockerfile (minimal Apache image)</h2>
<pre><code>
# Simple Apache image that serves Name + Roll No
FROM httpd:2.4-alpine

ARG STUDENT_NAME="Your Name"
ARG ROLL_NO="0000"

# Create a minimal index.html at container build time
RUN printf '&lt;!doctype html&gt;&lt;html&gt;&lt;head&gt;&lt;meta charset="utf-8"&gt;&lt;title&gt;Student&lt;/title&gt;&lt;/head&gt;&lt;body style="font-family: system-ui; margin: 3rem;"&gt;&lt;h1&gt;%s&lt;/h1&gt;&lt;h2&gt;Roll No: %s&lt;/h2&gt;&lt;p&gt;Served from Docker âœ…&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;' \
    "$STUDENT_NAME" "$ROLL_NO" \
    &gt; /usr/local/apache2/htdocs/index.html

EXPOSE 80
CMD ["httpd-foreground"]
</code></pre>

<h3>Install Docker</h3>

<pre><code>
# Step 1
sudo apt update
sudo apt upgrade -y

# Step 2
sudo apt remove docker docker-engine docker.io containerd runc

# Step 3
sudo apt install -y ca-certificates curl gnupg lsb-release

# Step 4
sudo mkdir -p /etc/apt/keyrings
curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /etc/apt/keyrings/docker.gpg

# Step 5
echo "deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.gpg] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable" | sudo tee /etc/apt/sources.list.d/docker.list > /dev/null

# Step 6
sudo apt update
sudo apt install -y docker-ce docker-ce-cli containerd.io docker-compose-plugin

# Step 7
sudo systemctl start docker
sudo systemctl enable docker
sudo systemctl status docker
</code></pre>

<h3>Build Docker Image</h3>
<pre><code>docker build -t student-apache .</code
